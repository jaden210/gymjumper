<mat-tab-group color="accent" id="tabs" [selectedIndex]="selectedTab" (selectedTabChange)="tabChanged($event)">
  <mat-tab label="Personal"> 
    <div class="column">
      <button mat-stroked-button class="image-button" color="primary" *ngIf="accountService.user.isDev" routerLink="/account/support">SUPPORT</button>
      <div class="image-cont">
        <div class="image-circle"><mat-progress-bar style="position: absolute;bottom: 0px;" *ngIf="loading" mode="indeterminate"></mat-progress-bar><img class="img" src={{accountService.user?.profileUrl}} onerror="src = '/assets/face.png'" alt="Gym Jumper"></div>
        <div style="height: 0px; width: 0px; overflow:hidden"><input type="file" id="upProfileUrl" accept=".png,.jpg,.mp4" #uploadT (change)="uploadProfileImage($event)"></div>
        <button mat-stroked-button *ngIf="!accountService?.user.profileUrl" class="image-button" color="primary" (click)="upload(true)">UPLOAD PICTURE</button>
      </div>
      <mat-form-field>
        <input matInput color="primary" placeholder="profile name" [(ngModel)]="accountService.user.name" (change)="saveProfile()">
      </mat-form-field>
      <mat-form-field>
        <input matInput color="primary" readonly placeholder="email" [(ngModel)]="accountService.user.email" (change)="saveProfile()">
      </mat-form-field>
      <mat-form-field>
        <input matInput color="primary" placeholder="phone" type="tel" [(ngModel)]="accountService.user.phone" (change)="saveProfile()">
      </mat-form-field>
      <button mat-stroked-button class="image-button" color="primary" (click)="accountService.logout()">LOGOUT</button>
      <button mat-button id="delete-account" color="warn" (click)="deleteAccount()"><mat-icon>delete</mat-icon> DELETE ACCOUNT</button>
    </div>
  </mat-tab>
  <mat-tab label="History"> 
    <mat-list>
      <mat-list-item *ngFor="let visit of accountService?.visits | keyvalue">
        <img matListAvatar src={{accountService?.visitedGyms[visit?.value.gymId]?.logoUrl}}>
        <h3 matLine>{{accountService?.visitedGyms[visit?.value.gymId]?.name}}</h3>
        <p matLine>
          <span> {{visit?.value.createdAt}} </span>
        </p>
      </mat-list-item>
      <div *ngIf="!accountService?.visits">No history yet... Visit a gym!</div>
    </mat-list>
  </mat-tab>
  <mat-tab label="Billing">
    <div id="billing">
      <ng-container *ngIf="!accountService.user.cardToken">
        <div class="card">
          <div class="free" *ngIf="accountService.trialDaysLeft > 0">You’re in a free trial period for {{accountService.trialDaysLeft}} more days. Payment can be entered any time, but is not required until your free trial is up. You’ll be charged based on your team size, on the one month anniversary of your account creation date according to our Customer Agreement which you agreed to when setting up your account. Feel free to review the <a routerLink="/customer-agreement">Customer Agreement</a> again. Based on your current team size, you will be charged ${{teamTier}} per month, and can cancel at any time. All payments are handled securely through Stripe.</div>
          <div class="free" *ngIf="accountService.trialDaysLeft <= 0">You’re free trial has expired. Please enter payment information to access your account. You’ll be charged based on your team size, on the one month anniversary of your account creation date according to our Customer Agreement which you agreed to when setting up your account. Feel free to review the <a routerLink="/customer-agreement">Customer Agreement</a> again. Based on your current team size, you will be charged ${{teamTier}} per month, and can cancel at any time. All payments are handled securely through Stripe.</div>
          <button mat-raised-button color="accent" style="color:#ffffff;align-self: flex-end" (click)="enterCardInfo()">ENTER PAYMENT</button>
        </div>
      </ng-container>
      <ng-container *ngIf="accountService.user.cardToken">
        <div class="card">
          <div class="free">Thank you! Your card is on file and securely stored with Stripe for monthly billing. Click below to update or change your payment information, anytime.</div>
          <button mat-raised-button color="accent" style="color:#ffffff;align-self: flex-end;" (click)="enterCardInfo()">UPDATE PAYMENT</button>
        </div>
      </ng-container>
      <div class="s-row">
        <div class="stripe-text">Payments are secured by </div>
        <div class="f-image"><img id="f-img" src="/assets/stripeName.png"></div>
      </div>
      <div id="bh" class="card">
        <div class="bh-row">
          <div id="bh-title">Billing History</div>
          <div class="flex"></div>
          <button mat-stroked-button color="accent" (click)="getBillingHistory()">
            last refreshed: {{accountService.user.stripeInvoicesRetrievedAt || 'never'}}
            <mat-icon [ngClass]="{spin: loadingBilling}">refresh</mat-icon>
          </button>
        </div>
        <div class="bh-row" *ngFor="let invoice of accountService.user.stripeInvoice?.data">
          {{invoice.date}}
        </div>
        <div id="no-bh" *ngIf="!accountService.user.stripeInvoice?.data?.length">
          <mat-icon>restore</mat-icon>No billing history
        </div>
      </div>
    </div>
  </mat-tab>
  <mat-tab label="My Gym" *ngIf="accountService?.isGymOwner">
      <div class="column">
          <div class="image-cont">
            <div class="image-circle"><mat-progress-bar style="position: absolute;bottom: 0px;" *ngIf="loading" mode="indeterminate"></mat-progress-bar><img class="img" src={{accountService.aGym?.logoUrl}} onerror="src = '/assets/face.png'" alt="Gym Jumper"></div>
            <div style="height: 0px; width: 0px; overflow:hidden"><input type="file" id="upLogoUrl" accept=".png,.jpg,.mp4" #uploadT (change)="uploadGymLogo($event)"></div>
            <button mat-stroked-button [disabled]="accountServive?.aGym?.ownerId == accountService?.user?.id" class="image-button" color="primary" (click)="upload(false)">CHANGE LOGO</button>
          </div>
          <mat-form-field>
            <input matInput color="primary" placeholder="gym name" [disabled]="accountServive?.aGym?.ownerId == accountService?.user?.id" [(ngModel)]="accountService.aGym.name" (change)="saveGym()">
          </mat-form-field>
          <mat-form-field>
            <input matInput color="primary" placeholder="email" [disabled]="accountServive?.aGym?.ownerId == accountService?.user?.id" [(ngModel)]="accountService.aGym.email" (change)="saveGym()">
          </mat-form-field>
          <mat-form-field>
            <input matInput color="primary" placeholder="phone" type="tel" [disabled]="accountServive?.aGym?.ownerId == accountService?.user?.id" [(ngModel)]="accountService.aGym.phone" (change)="saveGym()">
          </mat-form-field>
        </div>
  </mat-tab>
  <mat-tab label="Gym History" *ngIf="accountService?.isGymOwner"> 
      <mat-list>
        <mat-list-item *ngFor="let visit of accountService?.gymVisits | keyvalue">
          <img matListAvatar src={{accountService?.visitedUsers[visit?.value.userId]?.profileUrl}}>
          <h3 matLine>{{visit.value.userName}}</h3>
          <p matLine>
            <span> last visit: {{visit?.value.createdAt}} &nbsp;&nbsp;&nbsp;&nbsp; number of visits: {{visit.value.visitCount}} </span>
          </p>
        </mat-list-item>
      </mat-list>
    </mat-tab>
  <mat-tab label="Scanning Station" *ngIf="showGym">
  </mat-tab>
  </mat-tab-group>